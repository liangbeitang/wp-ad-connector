一、插件概述

WP・AD 互联插件为 WordPress 网站提供了与 Active Directory（AD）深度集成的功能。用户可以通过该插件实现 WordPress 用户与 AD 用户的同步管理，支持密码修改、邮件验证等功能，极大地提升了企业对 WordPress 用户管理的便捷性和安全性。

收起

plaintext

wp-ad-connector/
├── wp-ad-connector.php         // 主插件文件
├── readme.txt                  // 使用文档
├── languages/                  // 多语言支持目录
├── includes/
│   ├── class-ad-operator.php   // AD连接核心类
│   ├── class-user-sync.php     // 用户同步处理类
│   ├── class-password-reset.php// 密码修改模块类
│   ├── class-mail-service.php  // 邮件服务类
│   └── settings-page.php       // 设置界面类
├── admin/
│   └── admin-interface.php     // 管理界面文件
└── public/
    ├── user-profile.php        // 用户资料扩展文件
    └── templates/              // 模板文件目录
        └── password-form.php
二、功能特性

AD 集成功能：支持使用 LDAP 或 LDAPS 协议与 AD 进行连接，实现用户属性映射、自动角色分配和定时同步任务，确保 WordPress 用户库与 AD 中的用户信息保持一致。
密码管理功能：提供接口让用户可以在 WordPress 中修改其在 AD 中的密码，通过邮件验证码验证用户身份，强制用户设置符合强度策略的密码，并记录所有密码修改操作。
安全保障功能：使用 LDAPS 协议进行加密连接，记录所有与插件相关的操作，对登录和密码修改等操作设置失败尝试次数限制，对敏感数据进行加密存储。
多语言支持：提供多语言支持，方便不同地区用户使用。
三、安装步骤

下载插件：从 [https://www.liangbeitang.com] 下载插件压缩包。
上传插件：登录 WordPress 后台，导航到 “插件” -> “添加新插件”，点击 “上传插件”，选择下载的插件压缩包进行上传。
激活插件：上传完成后，点击 “激活插件” 按钮，激活 WP・AD 互联插件。
四、配置说明

1. 基本设置

登录 WordPress 后台，点击左侧菜单中的 “WP・AD 互联设置”。
在设置页面中，输入 AD 服务器地址、服务账户 DN、服务账户密码、基础 DN 等信息。
选择是否使用 LDAPS 协议进行连接。
设置默认用户角色和密码策略级别。
配置邮件服务，选择邮件服务商并填写相应的配置信息。
2. 同步设置

可以设置定时同步任务，建议每小时进行一次增量同步，每日凌晨进行一次全量同步。
也可以使用 WP – CLI 命令进行手动同步：wp ad-connector sync-users --full。
五、使用方法

1. 用户同步

插件会按照设置的定时任务自动进行用户同步，确保 WordPress 用户库与 AD 中的用户信息保持一致。
管理员也可以在管理界面手动触发用户同步操作。
2. 密码修改

用户访问/wp-admin/profile.php，点击 “修改 AD 密码” 链接。
输入当前密码、新密码和验证码，点击 “修改密码” 按钮。
系统会验证验证码和密码强度，若验证通过则更新 AD 和本地数据库中的密码。
六、常见问题解答

1. 无法连接到 AD 服务器怎么办？

检查 AD 服务器地址和端口是否输入正确。
检查服务账户 DN 和密码是否正确。
检查网络连接是否正常，确保可以访问 AD 服务器。
2. 用户同步失败如何处理？

检查 AD 服务器的连接配置是否正确。
检查服务账户是否具有足够的权限进行用户同步操作。
查看错误日志，根据日志信息排查问题。
3. 密码修改失败怎么办？

检查当前密码是否输入正确。
检查新密码是否符合密码强度策略。
检查验证码是否输入正确。
七、技术支持

如果在使用过程中遇到任何问题或需要进一步的技术支持，请联系 [https://www.liangbeitang.com]。

八、更新日志

v1.0

初始版本发布，支持 AD 集成、用户同步、密码管理等核心功能。
九、贡献者

[梁北棠 https://www.liangbeitang.com]